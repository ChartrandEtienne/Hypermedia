<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<script src="js/jquery.js"></script>

<script type="text/javascript">

var username = "UNLOG2"

$(document).ready(function() {

	$('#logout').hide();
    
    $('#usr_id').submit(function() {
		$.get('SetUserId', 'joueurId='+this["joueurId"].value); //        alert("usr_id: " + this["joueurId"].value);
		updateAll();
		return false;
    });

	$('#logout').submit(function() {
		$.get('Unlog');
		updateAll();		
		return false;
	});

	function displayJoueurs() {
		$.get('GetListJoueurs', "", function(data) {
			$('#listeUsagers').html(data);
			
		});
	}	

	function updateSession() {
		$.get('GetUserId', "", function(data) {
			if ($.trim(data) == "UNLOG") {
				$('#logout').hide();
				$('#username').text("Vous n'etes pas logue");
//				$('#usr_id').show();
				$('#tableLogin').show();
			} else {
				$('#logout').show();
				$('#username').text(data);
//				$('#usr_id').hide();
				$('#tableLogin').hide();
			}
//			$('#username').text(data);
		});
//		$('#username').text(username);
		return false;
	}


	function updateAll() {
		updateSession();
		displayJoueurs();
		return false;
	}

	window.setInterval(updateAll, 4000);



});

</script>

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>chess</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
</head>
<body>
<p id="username">null</p>
<p>
<table id="tableLogin">
<form id="usr_id" method="post" action="#">
<tr><td>username: </td><td><input type="text" name="joueurId"></td></tr>
<tr><td><input type="submit" value="OK" class="button" /></td></tr>
</form>
</table>
</p>
<!--
<form id="updateSession" method="post" action="#">
<input type="submit" value="update" class="button" />
</form>
-->
<p>
<table id="tableLogout">
<tr><td>
<form id="logout" method="post" action="#">
<input type="submit" value="logout" class="button" />
</form>
</td><tr></table>
</p>
<p id="listeUsagers">
</p>
</body>
</html>
